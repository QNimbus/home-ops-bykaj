---
apiVersion: volsync.backube/v1alpha1
kind: ReplicationDestination
metadata:
  name: ${APP}-restore
  namespace: default  # Target namespace
spec:
  trigger:
    manual: restore-once
  kopia:
    # Repository configuration in staging namespace
    repository: ${APP}-volsync-secret

    # Create or use existing PVC in staging
    destinationPVC: ${APP}
    copyMethod: Direct

    moverSecurityContext:
      runAsUser: ${APP_UID:=4000}
      runAsGroup: ${APP_GID:=4000}
      fsGroup: ${APP_GID:=4000}

    # Specify the source backup to restore from
    sourceIdentity:
      sourceName: ${APP}
      sourceNamespace: tools  # Source namespace
      # sourcePVCName is auto-discovered from the ReplicationSource